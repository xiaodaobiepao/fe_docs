<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>关于JavaScript类型 | 小刀别跑</title>
    <meta name="description" content="前端知识体系">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="icon" href="/fe_system/logo.png">
    
    <link rel="preload" href="/fe_system/assets/css/0.styles.86e8710a.css" as="style"><link rel="preload" href="/fe_system/assets/js/app.b00390c4.js" as="script"><link rel="preload" href="/fe_system/assets/js/2.838c8787.js" as="script"><link rel="preload" href="/fe_system/assets/js/19.b2965e83.js" as="script"><link rel="prefetch" href="/fe_system/assets/js/10.a595d528.js"><link rel="prefetch" href="/fe_system/assets/js/11.b5085c36.js"><link rel="prefetch" href="/fe_system/assets/js/12.c1e7dfc4.js"><link rel="prefetch" href="/fe_system/assets/js/13.f3f11ba5.js"><link rel="prefetch" href="/fe_system/assets/js/14.69a11933.js"><link rel="prefetch" href="/fe_system/assets/js/15.390bf5c2.js"><link rel="prefetch" href="/fe_system/assets/js/16.700c0bfa.js"><link rel="prefetch" href="/fe_system/assets/js/17.d0cdc913.js"><link rel="prefetch" href="/fe_system/assets/js/18.bdd7e270.js"><link rel="prefetch" href="/fe_system/assets/js/20.c6ab868c.js"><link rel="prefetch" href="/fe_system/assets/js/21.3d481287.js"><link rel="prefetch" href="/fe_system/assets/js/22.43d7648c.js"><link rel="prefetch" href="/fe_system/assets/js/23.b7fbf0f1.js"><link rel="prefetch" href="/fe_system/assets/js/24.2d48901e.js"><link rel="prefetch" href="/fe_system/assets/js/3.1a4a8964.js"><link rel="prefetch" href="/fe_system/assets/js/4.b0dd307f.js"><link rel="prefetch" href="/fe_system/assets/js/5.a81b0ad3.js"><link rel="prefetch" href="/fe_system/assets/js/6.41df2c4a.js"><link rel="prefetch" href="/fe_system/assets/js/7.d1bf94b9.js"><link rel="prefetch" href="/fe_system/assets/js/8.4f3f33a1.js"><link rel="prefetch" href="/fe_system/assets/js/9.527faec2.js">
    <link rel="stylesheet" href="/fe_system/assets/css/0.styles.86e8710a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/fe_system/" class="home-link router-link-active"><!----> <span class="site-name">小刀别跑</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/xiaodaobiepao/fe_system" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/xiaodaobiepao/fe_system" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>HTML</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>CSS</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>JavaScript</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>运行时</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/fe_system/js/runtime/001.html" class="active sidebar-link">关于JavaScript类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/fe_system/js/runtime/001.html#类型" class="sidebar-link">类型</a></li><li class="sidebar-sub-header"><a href="/fe_system/js/runtime/001.html#类型转换" class="sidebar-link">类型转换</a></li></ul></li><li><a href="/fe_system/js/runtime/002.html" class="sidebar-link">[源码篇] 手写Promise等API源码</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>文法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>语义</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络协议</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="关于javascript类型"><a href="#关于javascript类型" class="header-anchor">#</a> 关于JavaScript类型</h1> <h2 id="类型"><a href="#类型" class="header-anchor">#</a> 类型</h2> <p>javaScript语言的每一个值都属于一种类型，ES5规定了5种语言类型，ES6新增了Symbol类型，还有最近加入提案的BigInt类型，共有8种语言类型：</p> <ul><li>Undefined</li> <li>Null</li> <li>Boolean</li> <li>String</li> <li>Number</li> <li>Symbor</li> <li>BigInt</li> <li>Object</li></ul> <p>除了BigInt一般同学可能不知道，其他数据类型应该都听过。</p> <h3 id="undefined、null"><a href="#undefined、null" class="header-anchor">#</a> Undefined、Null</h3> <p><strong>Undefined</strong> 类型表示未定义，值为undefined, 一般可以用全局变量undefined或者void 操作符来表达这个值。</p> <p><strong>undefined</strong> 是全局变量而不是关键字，在旧版的浏览器中可能会被无意中篡改，所以我们可以用void 0来获取undefined值</p> <p><strong>Null</strong> 类型只有一个值 <strong>null</strong>，它的语义表示空，但它和 undefined 不同，他是js关键字，不可以被当做变量，因此不会被篡改。</p> <h3 id="boolean"><a href="#boolean" class="header-anchor">#</a> Boolean</h3> <p><strong>Boolean</strong> 表示逻辑真与假，没什么好说的</p> <h3 id="string"><a href="#string" class="header-anchor">#</a> String</h3> <p><strong>String</strong> 表示文本数据，最大长度为 <strong>2<sup>^</sup>53-1</strong>，但这个长度并不是字符数，而是受字符串的编码长度影响。</p> <p>字符串的操作 <strong>charAt、charCodeAt、length</strong> 等方法针对的都是 <strong>UTF16编码</strong>。</p> <blockquote><p>Note：现行的字符集国际标准，字符是以 Unicode 的方式表示的，每一个 Unicode 的码点表示一个字符，理论上，Unicode 的范围是无限的。UTF 是 Unicode 的编码方式，规定了码点在计算机中的表示方法，常见的有 UTF16 和 UTF8。 Unicode 的码点通常用 U+??? 来表示，其中 ??? 是十六进制的码点值。 0-65536（U+0000 - U+FFFF）的码点被称为基本字符区域（BMP）。</p></blockquote> <p><strong>JavaScript</strong> 字符串把每个UTF16单元当做一个字符处理，处理非BMP(超过U+0000 - U+FFFF范围)的字符时，可能会出错，所以ES6推出了<code>fromCodePoint</code>和<code>charCodePoint</code>等可以正确处理非常规字符的方法。</p> <h3 id="number"><a href="#number" class="header-anchor">#</a> Number</h3> <p>JabaScript 中的 Number 类型基本符合<strong>IEEE 754-2008</strong> 规定的双精度浮点数规则，但JavaScript新增了几个表达额外场景的值：</p> <ul><li><strong>NaN</strong> 不是数字的数字</li> <li><strong>Infinity</strong>，无穷大</li> <li><strong>-Infinity</strong>，负无穷大</li></ul> <p>JavaScript 中有 +0 和 -0，一般来说它们没有区别，但在除法中会有不同的地方。非0数字除以 -0 得到的是负无穷大，所以我们可以通过检测 1/x 的值是 Infinity 还是 -Infinity 来判断 x 是 +0 还是 -0。</p> <p>根据浮点数的定义，非整数的 Number 类型在判断是否相等时可能会出现意外的结果。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">0.1</span> <span class="token operator">+</span> <span class="token number">0.2</span> <span class="token operator">==</span> <span class="token number">0.3</span><span class="token punctuation">)</span>
<span class="token comment">// false</span>
</code></pre></div><p>这是浮点运算的特点，我们可以换一种方法来比较：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">abs</span><span class="token punctuation">(</span><span class="token number">0.1</span><span class="token operator">+</span><span class="token number">0.2</span><span class="token operator">-</span><span class="token number">0.3</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> Number<span class="token punctuation">.</span><span class="token constant">EPSILON</span><span class="token punctuation">)</span>
<span class="token comment">// true</span>
</code></pre></div><p><strong>Number.EPSILON</strong> 可以获取最小精度值</p> <h3 id="bigint"><a href="#bigint" class="header-anchor">#</a> BigInt</h3> <p><code>BigInt</code> 数据类型的目的是比Number数据类型支持范围更大的整数值，在对大整数执行数学运算时，整数溢出不再是问题。</p> <p><code>BigInt</code> 的使用方法很简单，在整数的末尾追加n即可。</p> <div class="language-JavaScript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">9007199254740995n</span><span class="token punctuation">)</span>
<span class="token comment">// 9007199254740995n</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">9007199254740995</span><span class="token punctuation">)</span>
<span class="token comment">// 9007199254740996</span>
</code></pre></div><p>或者调用 <code>BigInt()</code> 构造函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">BigInt</span><span class="token punctuation">(</span><span class="token string">&quot;9007199254740995&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 9007199254740995n</span>
</code></pre></div><h3 id="symbol"><a href="#symbol" class="header-anchor">#</a> Symbol</h3> <p><code>Symbol</code> 是ES6引入的新类型，它是一切非字符串的对象key的集合，在ES6规范中，整个对象系统被用 <code>Symbol</code> 重塑。</p> <p><code>Symbol</code> 可以具有字符串类型的描述，但即使描述相同，<code>Symbol</code> 也不相等。</p> <p>一般可以用全局的 <code>Symbol</code> 函数创建 <code>Symbol</code>:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> symbol <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'symbol'</span><span class="token punctuation">)</span>
</code></pre></div><p>一些标准中提到的 <code>Symbol</code>，可以在全局的 <code>Symbol</code> 函数的属性中找到。例如，我们可以使用 <code>Symbol.iterator</code> 来定义 <code>for...of</code> 在对象上的行为。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span>

    o<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>iterator<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> v <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">next</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token punctuation">{</span> value<span class="token operator">:</span> v<span class="token operator">++</span><span class="token punctuation">,</span> done<span class="token operator">:</span> v <span class="token operator">&gt;</span> <span class="token number">10</span> <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>        
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> v <span class="token keyword">of</span> o<span class="token punctuation">)</span> 
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 0 1 2 3 ... 9</span>
</code></pre></div><h3 id="object"><a href="#object" class="header-anchor">#</a> Object</h3> <p>在JavaScript中，对象的定义是“属性的集合”。属性分为数据属性和访问器属性，二者都是key-value结构，key可以是字符串或者Symbol类型。</p> <p>JavaScript中的几个基本类型，都在对象类型中有相应的构造器。</p> <ul><li>Number</li> <li>String</li> <li>Boolean</li> <li>Symbol</li></ul> <p>3其实和new Number(3)是完全不同的，一个是基本类型，一个是对象类型。</p> <p>但是基本类型却可以使用对象类型原型上的方法：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'abc'</span><span class="token function">charAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// a</span>
</code></pre></div><p>这是因为.操作符对相应的基本类型做了装箱操作，转为临时对象，使基本类型能够使用对象类型原型上的方法。接下来的类型转换会解释如何装箱及拆箱。</p> <h2 id="类型转换"><a href="#类型转换" class="header-anchor">#</a> 类型转换</h2> <p>JS是弱类型语言，所以类型转换很频繁，很多都是用户不清楚的隐性转换（这个时候就体现 <code>TypeScript</code> 的重要性了……），所以几乎所有规范都建议大家使用 <code>===</code> 全等，而不是 <code>==</code>，后者会试图跨类型比较，转换规则很复杂，有的转换也不符合直觉。</p> <p>其他加减乘除，大于小于都可能发生类型转换，基本规则如下：</p> <table><thead><tr><th style="text-align:center;">kong</th> <th style="text-align:center;">Boolean</th> <th style="text-align:center;">Number</th> <th style="text-align:center;">String</th> <th style="text-align:center;">Object</th></tr></thead> <tbody><tr><td style="text-align:center;">Null</td> <td style="text-align:center;">False</td> <td style="text-align:center;">0</td> <td style="text-align:center;">'null'</td> <td style="text-align:center;">TypeError</td></tr> <tr><td style="text-align:center;">Undefined</td> <td style="text-align:center;">False</td> <td style="text-align:center;">NaN</td> <td style="text-align:center;">'undefined'</td> <td style="text-align:center;">TypeError</td></tr> <tr><td style="text-align:center;">Boolean(true)</td> <td style="text-align:center;">-</td> <td style="text-align:center;">1</td> <td style="text-align:center;">'true'</td> <td style="text-align:center;">#装箱转换</td></tr> <tr><td style="text-align:center;">Boolean(false)</td> <td style="text-align:center;">-</td> <td style="text-align:center;">0</td> <td style="text-align:center;">'false'</td> <td style="text-align:center;">#装箱转换</td></tr> <tr><td style="text-align:center;">Numbler</td> <td style="text-align:center;">0,NaN-false</td> <td style="text-align:center;">#NumberToString</td> <td style="text-align:center;">#装箱转换</td> <td style="text-align:center;"></td></tr> <tr><td style="text-align:center;">String</td> <td style="text-align:center;">''-false</td> <td style="text-align:center;"></td> <td style="text-align:center;">#StringToNumber</td> <td style="text-align:center;">-</td></tr> <tr><td style="text-align:center;">Symbol</td> <td style="text-align:center;">True</td> <td style="text-align:center;">TypeError</td> <td style="text-align:center;">'Symbol(symbol)'</td> <td style="text-align:center;">#装箱转换</td></tr> <tr><td style="text-align:center;">Object</td> <td style="text-align:center;">True</td> <td style="text-align:center;">#拆箱转换</td> <td style="text-align:center;">#拆箱转换</td> <td style="text-align:center;">-</td></tr></tbody></table> <p>比较复杂的是Number和String之间的转换，以及对象与基本类型之间的装箱，拆箱操作。</p> <h3 id="stringtonumber"><a href="#stringtonumber" class="header-anchor">#</a> StringToNumber</h3> <p>字符串到数字转换，可以支持十进制，十六进制，二进制和八进制。</p> <ul><li>30</li> <li>0b111  二进制</li> <li>0o13 八进制</li> <li>0xFF 十六进制</li></ul> <p>还有科学计数法：</p> <ul><li>1e2</li> <li>-1e-6</li></ul> <p><code>parseInt</code> 和 <code>parseFloat</code> 不支持科学计数法</p> <p><code>parseInt</code> 第二个参数可以传入进制，如果忽略该参数，<code>parseInt</code> 可以支持 <code>0x</code> 开头的字符串，一些老版浏览器还支持 0 开头的作为8进制解析。</p> <p><code>parseFloat</code> 可以转换浮点数，并且直接按照十进制来解析，不会引入进制概念。</p> <p><code>parseInt</code> 和 <code>parseFloat</code> 都会忽略字符串中非数字的解析，<code>Number</code> 会把包含非数字的字符串转换为 <code>NaN</code>。</p> <h3 id="numbertostring"><a href="#numbertostring" class="header-anchor">#</a> NumberToString</h3> <p>一般是直接转成字符串形式的数字，但如果数字范围过大话，可能会转为科学计数法的形式，保证字符串的长度不会过长。</p> <h3 id="装箱转换"><a href="#装箱转换" class="header-anchor">#</a> 装箱转换</h3> <p>每一种基本类型都能在对象中找到对应的类，装箱操作，就是把基本类型转为对应的对象类型。</p> <p>装箱机制会频繁产生临时对象，对性能要求较高的场景，应尽量避免对基本类型做装箱转换。</p> <p>使用内置Object函数，可以显式调用装箱操作。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>    <span class="token keyword">var</span> symbolObject <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">&quot;a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> symbolObject<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//object</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>symbolObject <span class="token keyword">instanceof</span> <span class="token class-name">Symbol</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>symbolObject<span class="token punctuation">.</span>constructor <span class="token operator">==</span> Symbol<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//true</span>
</code></pre></div><p>每一种装箱对象都有私有的Class属性，可以用Object.prototype.toString获取：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">var</span> symbolObj <span class="token operator">=</span> <span class="token function">Object</span><span class="token punctuation">(</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>symbolObj<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// [String Symbol]</span>
</code></pre></div><h3 id="拆箱转换"><a href="#拆箱转换" class="header-anchor">#</a> 拆箱转换</h3> <p>JavaScript 规定了 <code>ToPrimitive</code> 函数，可以对对象类型转换成基本类型。</p> <p>对象到Number或者String的过程，遵循先转为基本类型，再转换为对应的String或Number的规则。</p> <p><code>ToPrimitive</code> 转为基本类型时，是用的对象的默认值。使用的是内部的 <code>[[DefaultValue]](hint)</code>，拆箱操作根据 <code>hint</code> 的不同采取不同的处理方式，<code>hit</code> 是 <code>String</code> 时优先调用 <code>toString</code> 方法，反之则优先调用 <code>valueOf</code>，如果返回值不是基本类型，则会报错 <code>TypeError</code>。</p> <p>除了日期外，如果没传 <code>hint</code> 值，hint值默认为 <code>Number</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">valueOf</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">toString</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    o <span class="token operator">*</span> <span class="token number">2</span>
    <span class="token comment">// valueOf</span>
    <span class="token comment">// toString</span>
    <span class="token comment">// TypeError</span>
</code></pre></div><p>而如果是日期</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
<span class="token comment">// &quot;Wed Feb 12 2020 11:54:51 GMT+0800 (中国标准时间)1&quot;</span>
</code></pre></div><p>或者显式传入hint</p> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">var</span> o <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function-variable function">valueOf</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;valueOf&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function-variable function">toString</span> <span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;toString&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">return</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">String</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// toString</span>
    <span class="token comment">// valueOf</span>
    <span class="token comment">// TypeError</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/fe_system/css/features/001.html" class="prev">
        布局
      </a></span> <span class="next"><a href="/fe_system/js/runtime/002.html">
        [源码篇] 手写Promise等API源码
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/fe_system/assets/js/app.b00390c4.js" defer></script><script src="/fe_system/assets/js/2.838c8787.js" defer></script><script src="/fe_system/assets/js/19.b2965e83.js" defer></script>
  </body>
</html>
